# Embedding Service üöÄ

Standalone –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤–µ–∫—Ç–æ—Ä–Ω—ã—Ö —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –∏–∑ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ (Markdown, TXT) —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π GPU-—É—Å–∫–æ—Ä–µ–Ω–∏—è –∏ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –ø–∞–Ω–µ–ª—å—é –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.

## ‚ú® –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **–ì–∏–±—Ä–∏–¥–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞—Ç–∏–≤–Ω–æ (—á–µ—Ä–µ–∑ —Ñ–æ–Ω–æ–≤—ã–µ –ø–æ—Ç–æ–∫–∏) –∏–ª–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ Celery + Redis.
- **–£–º–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ Markdown-—Ä–∞–∑–º–µ—Ç–∫–∏ –∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –≤–µ–∫—Ç–æ—Ä–æ–≤.
- **Dashboard**: –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –≤–µ–±-–ø–∞–Ω–µ–ª—å –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∑–∞–¥–∞—á –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.
- **BLOB-—Ñ–æ—Ä–º–∞—Ç**: –í–æ–∑–≤—Ä–∞—Ç —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –≤ –∫–æ–º–ø–∞–∫—Ç–Ω–æ–º –±–∏–Ω–∞—Ä–Ω–æ–º –≤–∏–¥–µ (pickle) —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ –≤ HTTP-–∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö.
- **GPU-—É—Å–∫–æ—Ä–µ–Ω–∏–µ**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ NVIDIA GPU (Linux) –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–¥ Apple Silicon.

## üõ† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **FastAPI**: –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π API.
- **SQLAlchemy + SQLite**: –•—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏ —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–¥–∞—á.
- **Celery + Redis**: –û—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).
- **Sentence Transformers**: –ú–æ—â–Ω—ã–µ –º–æ–¥–µ–ª–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `BAAI/bge-m3`).

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ù–∞—Ç–∏–≤–Ω—ã–π –∑–∞–ø—É—Å–∫ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è —Ç–µ—Å—Ç–æ–≤)
–ù–µ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∫—Ä–æ–º–µ Python.

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt

# –ó–∞–ø—É—Å–∫
python main.py
```
*Dashboard –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:8001/*

### 2. Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)

**macOS / CPU:**
```bash
docker-compose up -d --build
```

**Linux + NVIDIA GPU:**
```bash
docker-compose -f docker-compose.yml -f docker-compose.nvidia.yml up -d --build
```

## üì° API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

- `GET  /` ‚Äî Dashboard (–≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å).
- `POST /api/async/embedding/submit` ‚Äî –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ (multipart/form-data). –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `job_id`.
- `GET  /api/async/embedding/status/{job_id}` ‚Äî –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ (0-100%).
- `GET  /api/async/embedding/result/{job_id}` ‚Äî –°–∫–∞—á–∏–≤–∞–Ω–∏–µ BLOB-—Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞.
- `GET  /api/async/embedding/health` ‚Äî –°—Ç–∞—Ç—É—Å –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–∞.
- `GET  /docs` ‚Äî Swagger UI –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è.

## üìñ –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤ –æ—Ç–≤–µ—Ç–∞—Ö
–ü—Ä–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ (`/result/{job_id}`) –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è:
- `X-Vector-Dim`: –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤–µ–∫—Ç–æ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 1024).
- `X-Chunk-Count`: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ–≥–º–µ–Ω—Ç–æ–≤.
- `X-Model-Id`: –ù–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏.

## üìÇ –°—Å—ã–ª–∫–∏
- [–î–µ—Ç–∞–ª—å–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é](docs/USAGE.md)
- [–ì–∞–π–¥ –ø–æ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –≤ Elasticsearch](file:///Users/dev/.gemini/antigravity/brain/dbf4499b-a310-4799-9265-41cdc1186d6c/indexing_guide.md)
